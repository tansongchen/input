<script setup>
import Practice from '../components/Practice.vue'
import roots from './roots.yaml'

const 声韵 = Object.entries({
  // 声母
  zh: 'z',
  ch: 'c',
  sh: 's',
  er: 'a',
  ir: 'a',
  i: 'i',
  'u ü': 'u',
  // 韵母：开口呼
  'a ia ua': 'a',
  'e ie üe': 'e',
  'o io uo': 'o',
  'ai uai': ';',
  'ei uei': ',',
  'ao iao': '/',
  'ou iou': '.',
  'an ian uan üan': ';',
  'en in uen ün': ',',
  'ang iang uang': '/',
  'eng ing ueng ong iong': '.'
})

const 零声母音节 = Object.entries({
  // 韵母：开口呼
  a: 'va',
  ai: 'v;',
  ao: 'v/',
  an: 'v;',
  ang: 'v/',
  e: 've',
  ei: 'v,',
  en: 'v,',
  eng: 'v.',
  er: 'va',
  o: 'vo',
  ou: 'v.',
  // 韵母：合口呼
  wu: 'wu',
  wa: 'wa',
  wai: 'w;',
  wan: 'w;',
  wang: 'w/',
  wo: 'wo',
  wei: 'w,',
  wen: 'w,',
  weng: 'w.',
  // 韵母：齐齿呼
  yi: 'yi',
  ya: 'ya',
  yao: 'y/',
  yan: 'y;',
  yang: 'y/',
  ye: 'ye',
  yin: 'y,',
  ying: 'y.',
  yo: 'yo',
  yong: 'y.',
  you: 'y.',
  // 韵母：撮口呼
  yu: 'yu',
  yuan: 'y;',
  yue: 'ye',
  yun: 'y,',
});

const 主根 = roots.filter(x => !("读音" in x)).map(x => [x.字根, x.编码]);
const 副根 = roots.filter(x => "读音" in x).map(x => [`${x.字根} [${x.读音}]`, x.编码]);
</script>

# 拼写规则

本方案中，「拼写」一词有双重含义：将不带调的汉语拼音音节分解为声母和韵母，它们一方面直接用于输入词语的各个音节，另一方面用于定义一系列字根的编码，这些字根可以用于输入单字。例如：

- 「八 ba」可以分解为声母 b 和韵母 a，因此它作为词语的音码编码就是 `ba`；
- 「八 ba」同时也是一个字根，这个字根的形码编码也是 `ba`。

注意，有些音节在用汉语拼音拼写时作了一些变形，本方案中，在分解为声母和韵母时要首先把这些音节还原为原始的形式：

- 声母 j, q, x 后面接 u 时要还原为原始形式 ü，例如「娟 juan」分解为 j + üan；
- 韵母 iu, ui, un 还原为原始形式 iou, uei, uen，例如「秋 qiu」分解为 q + iou，「归 gui」分解为 g + uei，「魂 hun」分解为 h + uen；

下面我们来依次对声母和韵母编码。

## 声母

声母的编码与汉语拼音中基本相同，区别仅仅在于 zh, ch, sh 这三个声母分别合并到了 z, c, s（即不分平翘舌）。

## 韵母

韵母首先大致按照《中华通韵》中的韵部归并，然后安排在 `aeiou;,./` 九个键上。其对应关系如下表：

| 韵母                                      | 编码 |
| ----------------------------------------- | ---- |
| a, ia, ua, er, ir                         | a    |
| o, io, uo                                 | o    |
| e, ie, üe                                 | e    |
| i                                         | i    |
| u, ü                                      | u    |
| an, ian, uan, üan, ai, uai, n             | ;    |
| en, in, uen, ün, ei, uei                  | ,    |
| ang, iang, uang, ao, iao                  | /    |
| eng, ing, ueng, ong, iong, ou, iou, ng, m | .    |

其中，ir 是一个特殊的韵母，它用来表示 zhi, chi, shi, ri 等音节中的卷舌色彩舌尖元音，且归并到 er。例如，「四 si」编码是 `si`，但「十 shi」分解为声母 sh 和韵母 ir，编码为 `sa`。

请您在下面的小游戏中练习声母和韵母的拼写：

<Practice :data="声韵" name="冰雪清韵-声韵" />

## 零声母音节

汉语拼音中除了 b, p, m, f, d, t, n, l, g, k, h, j, q, x, zh, ch, sh, r, z, c, s 这 21 个声母之外，还有若干音节没有声母，这些音节称为零声母音节。在汉语拼音的拼写中，凡是以 a, e, o, w, y 这几个字母开头的音节都属于零声母音节，如「安 an」、「弯 wan」、「烟 yan」、「冤 yuan」等（y 和 w 按汉语拼音的规定并不是声母，而是韵母自成音节时变形的产物），它们只有韵母的成分而没有声母。纯鼻音音节如「嗯 ng」「呒 m」等也算零声母音节。

本方案对零声母音节的处理如下：

- a, ai, an, ang, ao, e, ei, en, eng, er, o, ou, m, n, ng：引导键为 `v`。例如要输入「安 an」，需要先打 `v` 然后输入 an 的编码，因此最终编码为 `v;`；
- wa, wai, wan, wang, wei, wen, weng, wo, wu：这些音节是由韵母 ua, uai, uan, uang, uei, uen, ueng, uo, u 在自成音节时变形得来的；引导键为 `w`。例如要输入「弯 wan」，需要先打 `w` 然后输入 uan 的编码，因此最终编码为 `w;`；
- ya, yan, yang, yao, ye, yi, yin, ying, yong, you, yu, yuan, yue, yun：这些音节是由韵母 ia, ian, iang, iao, ie, i, in, ing, iong, iou, ü, üan, üe, ün 在自成音节时变形得来的；引导键为 `y`。例如要输入「烟 yan」或「冤 yuan」，需要先打 `y` 然后输入 ian 或者 üan 的编码，因此最终编码均为 `y;`。

不严格地说，也可以认为本方案以 `w` 和 `y` 为以它们开头的音节的形式上的声母，然后将 wan 拆分为 w + an，yan 拆分为 y + an 并编码。由于 an, ian, uan, üan 最终合并在一个键上，所以结果是一样的。

请您在下面的小游戏中练习零声母音节的拼写：

<Practice :data="零声母音节" name="冰雪清韵-零声母音节" />

## 开始冰雪清韵的旅程！

虽然到现在您只学完了冰雪清韵的音码部分，但是我们建议您立即开始使用音码在「整句」模式下打字，其中每个音节可以完整输入声母和韵母，也可以只输入声母（即简拼）。在这个模式下，您可以打好基础，最快地熟悉拼写规则。

请在您的用户文件夹新建 `snow_qingyun.custom.yaml`，并在其中写入以下内容：

```yaml
patch:
  # 开启整句模式
  switches/@4/reset: 0
```

重新部署后，您就可以用上面的拼写规则来输入任意长度的句子：

![](https://images.tansongchen.com/1758925916.png)

## 字根

下面我们将利用声母、韵母来定义每个字根的两个编码，即声码和韵码。对于绝大多数字根（85%）来说，声码和韵码就是字根声母和韵母对应的编码，而非成字字根则会归并到形似的成字字根上，这些字根称为「副根」；但为了提升形码编码的离散能力和手感，存在一些高频字根，它的声码和韵码是无理的，这些字根称为「主根」。主根又分为「第一主根」和「第二主根」，其区别在于韵码不同。

| 类别     | 组数 | 个数 | 声码 | 韵码 |
| -------- | ---- | ---- | ---- | ---- |
| 第一主根 | 6    | 6    | 无理 | `e`  |
| 第二主根 | 21   | ?    | 无理 | `o`  |
| 副根     | 140  | ?    | 声母 | 韵母 |

## 第一主根

第一主根包括横、竖、撇、点、顺折和逆折这 6 个单笔字根（下面在练习时，分别用一、丨、丿、丶、乛、乚表示），其声码分别规定为 `αβγδεζ`，韵码规定为 `e`。

- 顺折（乛）：第一次转折的方向为顺时针，包括横钩、横撇、横折、横折钩、横斜钩、横折提、横折折、横折弯、横撇弯钩、横折弯钩、横斜弯钩、横折折撇、横折折折、横折折折钩、竖弯左、弯钩、撇钩
- 逆折（乚）：第一次转折的方向为逆时针，包括竖提、竖折、竖弯、竖弯钩、竖折撇、竖折折钩、竖折折、撇点、撇折、斜钩、卧钩

由于手写画圈时一般是逆时针，所以圈和其他特殊笔画也归类为「逆折」。

## 第二主根

第二主根有 21 组，其声码分别规定为 `bpmfdtnlgkhjqxzcsrwyv`，韵码规定为 `o`。这些字根的声码并不是字根声母的键位，需要特别记忆，不过这是为了提高形码性能的必要牺牲。

请您在下面的小游戏中练习第一主根和第二主根的拼写：

<Practice :data="主根" name="冰雪清韵-主根" songti />

## 副根

副根有 140 组，声码和韵码就是字根声母和韵母对应的编码。为了提高离散和手感，对于零声母音节 yu, yuan, yue, yun 声码没有用 y 而是用了 v（但请注意这个规则并不适用于音码部分）。

请您在下面的小游戏中练习副根的拼写，练习时会提示其读音：

<Practice :data="副根" name="冰雪清韵-副根" songti />
